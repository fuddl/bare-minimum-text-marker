{"version":3,"sources":["../../src/index.jsx","App.js","index.js"],"names":["TextMarker","yOffset","x","y","color","fontFamily","gap","i","id","label","opacity","pointer","size","transforms","labelRef","useRef","useState","visible","setVisible","useEffect","first","second","allTexts","document","querySelectorAll","thisBox","current","getBBox","text","otherBox","getAttribute","width","height","tx","ty","React","fill","fontSize","textAnchor","data-text-marker-pointer","ref","data-text-marker-label","textMarker","element","map","key","sceneSettings","cubeRange","cubeZoffset","dataXoffset","dataYoffset","dataZoffset","paperXrange","window","innerWidth","paperYrange","innerHeight","sceneOptions","paper","xyPlane","sceneEdges","crossLines","emptySceneOptions","App","zoom","setZoom","rotateX","setRotateX","rotateY","setRotateY","viewSettings","camTx","camTy","camTz","cubeRx","cubeRy","cubeRz","camZoom","canvasToViewRatio","defaultCamZoffset","defaultCamOrientation","points","renderScene","data","catalog","star","type","location","z","push","name","symbol","labelSize","style","onWheel","e","destZoom","deltaY","onMouseMove","clientX","clientY","class","href","container","xRange","yRange","plugins","ReactDOM","render","getElementById"],"mappings":"gzCASMA,EAAa,YAafC,IAZAC,EAYAD,EAZAC,EACAC,EAWAF,EAXAE,EACAC,EAUAH,EAVAG,MACAC,EASAJ,EATAI,WACAC,EAQAL,EARAK,IACAC,EAOAN,EAPAM,EACAC,EAMAP,EANAO,GACAC,EAKAR,EALAQ,MACAC,EAIAT,EAJAS,QACAC,EAGAV,EAHAU,QACAC,EAEAX,EAFAW,KACAC,EACAZ,EADAY,WACAZ,YAEIa,EAAWC,mBACjBL,MAAY,GACZE,MAAS,IACTD,MAAY,UACZL,MAAQM,EAAK,GACbX,MAAYW,EAAK,GAPfX,MAS8Be,uBAT9Bf,mBASMgB,EATNhB,KASeiB,EATfjB,KAWFkB,qBAAU,WACR,IADQ,EA/BMC,EAAOC,EAgCfC,EAAWC,SAASC,iBAAiB,mBACvCC,EAAUX,EAASY,QAAQC,UAFvB,cAGQL,GAHR,IAGR,2BAA0B,KAAlBM,EAAkB,QACxB,GAAId,EAASY,UAAYE,EAEvB,YADAV,MAGF,IAAIW,EAAWD,EAAKD,UAEpB,GAAe,GADDC,EAAKE,aAAa,aAxCpBV,EAyCiBK,GAxCpBvB,GADUmB,EAyCmBQ,GAxClB3B,EAAImB,EAAOU,OAC5BX,EAAMlB,EAAIkB,EAAMW,MAAQV,EAAOnB,GAC/BkB,EAAMjB,EAAIkB,EAAOlB,EAAIkB,EAAOW,QAC5BZ,EAAMjB,EAAIiB,EAAMY,OAASX,EAAOlB,EAuCjC,YADAe,OAXI,8BAeRA,QACC,CAAChB,EAAEC,IAEN,IAAM8B,EAAKpB,EAAWoB,GAAG/B,GACnBgC,EAAKrB,EAAWqB,GAAG/B,GAAGF,EAE5B,OACEkC,uBACEC,KAAMhC,EACNiC,SAAUzB,EACVP,WAAYA,EACZG,aAAOA,EAAPA,YAAaD,IAEb4B,0BACEjC,EAAG+B,EACH9B,EAAG+B,EACHI,WAAW,SACXC,+BAEC5B,GAEHwB,0BACEjC,EAAG+B,EAAK3B,EACRH,EAAG+B,EACHM,IAAK1B,EACLJ,QAASO,EAAUP,EAAU,EAC7B4B,WAAW,OACXG,6BAEChC,KAkCaF,EA5BG,CACvBmC,WAAY,SAACC,EAAS9B,OAElBD,EAQE+B,EATE/B,KAEJR,EAOEuC,EATE/B,MAGJF,EAMEiC,EATE/B,QAIJJ,EAKEmC,EATE/B,GAKJH,EAIEkC,EATE/B,MAMJD,EAGEgC,EATE/B,QAOJP,EAEEsC,EATE/B,WAQJX,EACE0C,EATE/B,QAUN,OAAO+B,EAAQzC,EAAE0C,KAAI,SAAC1C,EAAGK,GAAJ,OACnB4B,kBAACnC,GAEGE,IACAC,EAAGwC,EAAQxC,EAAEI,GACbH,QACAC,aACAE,IACAC,KACAC,QACAC,UACAC,UACAC,OACAC,aACAZ,UAEF4C,cAAQrC,EAARqC,YAActC,U,OCzGhBuC,EAAgB,CACpBC,UAAW,GACXC,YAAa,EACbC,YAAa,EACbC,YAAa,EACbC,YAAa,IACbC,YAAaC,OAAOC,WACpBC,YAAaF,OAAOG,aAGhBC,EAAe,CACnBC,OAAO,EACPC,SAAS,EACTC,WAAY,CAAExD,MAAO,UAAWM,QAAS,GACzCmD,YAAY,GAGRC,EAAoB,CACxBJ,OAAO,EACPC,SAAS,EACTC,YAAY,EACZC,YAAY,GA4HCE,MAzHf,WAAgB,IAAD,IACW/C,mBAAS,GADpB,mBACNgD,EADM,KACAC,EADA,OAEiBjD,mBAAS,GAF1B,mBAENkD,EAFM,KAEGC,EAFH,OAGiBnD,mBAAS,GAH1B,mBAGNoD,EAHM,KAGGC,EAHH,KAKPC,EAAe,CACnBC,MAAO,EACPC,MAAO,EACPC,MAAO,EACPC,OAAQR,EACRS,OAAQ,EACRC,OAAQR,EACRS,QAASb,EACTc,kBAAmB,IACnBC,kBAAmB,EACnBC,sBAAuB,qBAUrBC,EAAS,CAPEC,YACbZ,EACAxB,EACAW,EACA,IAJI0B,KAQC,IA1BM,cA4BIC,GA5BJ,IA4Bb,2BAA0B,CAAC,IAAlBC,EAAiB,QAClBF,EAASD,YACbZ,EACAxB,EACAgB,EACA,CAAC,CACCwB,KAAM,SACNpF,EAAG,CAACmF,EAAKE,SAASrF,GAClBC,EAAG,CAACkF,EAAKE,SAASpF,GAClBqF,EAAG,CAACH,EAAKE,SAASC,MARhBL,KAcNF,EAAOQ,KAAP,2BACKN,EAAK,IADV,IAEE1E,MAAO4E,EAAKK,KACZlF,GAAI6E,EAAKK,KACT/E,QAAS0E,EAAKM,OAASN,EAAKM,OAAS,KACrCL,KAAM,aACN5E,QAAS,EACTE,KATgB,GAUhBX,QAAyB,WAAhBoF,EAAKM,OAVE,GAUyB,IAAMC,EAC/CxF,MAAO,YApDE,8BAyDb,OACE,sBACEyF,MAAO,CAAE9D,MAAO,OAAQC,OAAQqB,OAAOG,aACvCsC,QAAS,SAACC,GACR,IAAIC,EAAWhC,EAAQ+B,EAAEE,OAAO,IAC5BD,EAAW,GACb/B,EAAQ+B,IAGZE,YAAa,SAACH,GACZ1B,GAAY0B,EAAEI,QAAQ,GACtBhC,EAAW4B,EAAEK,QAAQ,IAVzB,UAaE,sBAAKC,MAAM,QAAX,UACE,kEAEG,IACD,mBAAGC,KAAK,yDAAR,sCACC,IAJH,aAMG,IACD,mBAAGA,KAAK,2CAAR,6BAGC,IAVH,MAYG,IACD,mBAAGA,KAAK,2CAAR,gBAGC,IAhBH,cAmBA,6IAIA,kGAGA,oDAEG,IACD,mBAAGA,KAAK,4BAAR,sBACC,IACD,sCAAQ,mBAAGA,KAAK,qDAAR,yBAAR,aAGJ,cAAC,IAAD,CACEC,UAAW,CACTnG,MAAO,QACPM,QAAS,QACT8F,OAAQ,IACRC,OAAQ,KAEVtB,KAAMF,EACNyB,QAAS,CAAChE,SC1IlBiE,IAASC,OAAO,cAAC,EAAD,IAASrF,SAASsF,eAAe,W","file":"static/js/main.a9eee654.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\n\nconst collides = (first, second) => {\n  return first.x < second.x + second.width &&\n         first.x + first.width > second.x &&\n         first.y < second.y + second.height &&\n         first.y + first.height > second.y\n}\n\nconst TextMarker = ({\n    x,\n    y,\n    color,\n    fontFamily,\n    gap,\n    i,\n    id,\n    label,\n    opacity,\n    pointer,\n    size,\n    transforms,\n    yOffset,\n  }) => {\n  const labelRef = useRef()\n  opacity ||= 1\n  size ||= 16\n  pointer ||= '•'\n  gap ||= size/2\n  yOffset ||= size/3\n\n  const [ visible, setVisible ] = useState(false)\n\n  useEffect(() => {\n    const allTexts = document.querySelectorAll('text:last-child')\n    let thisBox = labelRef.current.getBBox()\n    for(let text of allTexts) {\n      if (labelRef.current === text) {\n        setVisible(true)\n        return\n      }\n      let otherBox = text.getBBox()\n      let opacity = text.getAttribute('opacity')\n      if (opacity != 0 && collides(thisBox, otherBox)) {\n        setVisible(false)\n        return\n      }\n    }\n    setVisible(true)\n  }, [x,y])\n\n  const tx = transforms.tx(x)\n  const ty = transforms.ty(y)+yOffset\n\n  return (\n    <g\n      fill={color}\n      fontSize={size}\n      fontFamily={fontFamily}\n      id={`${id}-${i}`}\n    >\n      <text\n        x={tx}\n        y={ty}\n        textAnchor=\"middle\"\n        data-text-marker-pointer={true}\n      >\n        {pointer}\n      </text>\n      <text\n        x={tx + gap}\n        y={ty}\n        ref={labelRef}\n        opacity={visible ? opacity : 0}\n        textAnchor=\"left\"\n        data-text-marker-label={true}\n      >\n        {label}\n      </text>\n    </g>\n  )\n}\n\nconst textMarkerPlugin = {\n  textMarker: (element, transforms) => {\n    const {\n      size,\n      color,\n      opacity,\n      id,\n      label,\n      pointer,\n      fontFamily,\n      yOffset,\n    } = element\n    return element.x.map((x, i) => (\n      <TextMarker\n        {...{\n          x,\n          y: element.y[i],\n          color,\n          fontFamily,\n          i,\n          id,\n          label,\n          opacity,\n          pointer,\n          size,\n          transforms,\n          yOffset,\n        }}\n        key={`${id}-${i}`}\n      />\n    ))\n  }\n}\n\nexport default textMarkerPlugin\n","import React, { useState } from 'react'\nimport BareMinimum2d from 'bare-minimum-2d'\nimport renderScene from '@mithi/bare-minimum-3d'\nimport catalog from './catalog.json'\nimport textMarker from 'bare-minimum-text-marker'\n\nconst sceneSettings = {\n  cubeRange: 20,\n  cubeZoffset: 0,\n  dataXoffset: 0,\n  dataYoffset: 0,\n  dataZoffset: .25,\n  paperXrange: window.innerWidth,\n  paperYrange: window.innerHeight,\n}\n\nconst sceneOptions = {\n  paper: false,\n  xyPlane: false,\n  sceneEdges: { color: \"#607D8B\", opacity: 1 },\n  crossLines: false,\n}\n\nconst emptySceneOptions = {\n  paper: false,\n  xyPlane: false,\n  sceneEdges: false,\n  crossLines: false,\n}\n\nfunction App() {\n  const [zoom, setZoom] = useState(2);\n  const [rotateX, setRotateX] = useState(0);\n  const [rotateY, setRotateY] = useState(0);\n\n  const viewSettings = {\n    camTx: 0,\n    camTy: 0,\n    camTz: 0,\n    cubeRx: rotateX,\n    cubeRy: 0,\n    cubeRz: rotateY,\n    camZoom: zoom,\n    canvasToViewRatio: 300,\n    defaultCamZoffset: 5,\n    defaultCamOrientation: \"z-forward-x-right\",\n  }\n\n  let { data } = renderScene(\n    viewSettings,\n    sceneSettings,\n    sceneOptions,\n    [],\n  )\n\n  let points = [\n    data[0]\n  ]\n  for (let star of catalog) {\n    let { data } = renderScene(\n      viewSettings,\n      sceneSettings,\n      emptySceneOptions,\n      [{\n        type: 'points',\n        x: [star.location.x],\n        y: [star.location.y],\n        z: [star.location.z],\n      }],\n    )\n\n    const labelSize = 16\n\n    points.push({\n      ...data[0],\n      label: star.name,\n      id: star.name,\n      pointer: star.symbol ? star.symbol : null,\n      type: 'textMarker',\n      opacity: 1,\n      size: labelSize, \n      yOffset: star.symbol !== '☉' ? labelSize/2.8 : labelSize/4, \n      color: 'white',\n    })\n\n  }\n\n  return (\n    <div\n      style={{ width: '100%', height: window.innerHeight }}\n      onWheel={(e) => {\n        let destZoom = zoom + (e.deltaY/100)\n        if (destZoom > 0) {\n          setZoom(destZoom)\n        }\n      }}\n      onMouseMove={(e) => {\n        setRotateY(-e.clientX/3)\n        setRotateX(e.clientY/3)\n      }}\n    >\n      <div class=\"intro\">\n        <p>\n          This is a demo application of the \n          {' '}\n          <a href=\"https://www.npmjs.com/package/bare-minimum-text-marker\">bare-minimum-text-marker</a>\n          {' '}\n          plugin for\n          {' '}\n          <a href=\"https://github.com/mithi/bare-minimum-2d\">\n            bare-minimum-2d\n          </a>\n          {' '}\n          and \n          {' '}\n          <a href=\"https://github.com/mithi/bare-minimum-3d\">\n            3d\n          </a>\n          {' '}\n          library.\n        </p>\n        <p>\n          It allows you to place a text next to a point. The library\n          makes sure that text does not overlap other text. \n        </p> \n        <p>\n          This demo visualises the stellar neigborhood of the sun (☉). \n        </p> \n        <p>\n          Data extracted from \n          {' '}\n          <a href=\"https://www.wikidata.org/\">wikidata</a>\n          {' '}\n          <small>(<a href=\"https://creativecommons.org/publicdomain/zero/1.0/\">CC0 License</a>)</small>\n        </p> \n      </div>\n      <BareMinimum2d\n        container={{\n          color: 'black',\n          opacity: 'black',\n          xRange: 1000,\n          yRange: 2000\n        }}\n        data={points}\n        plugins={[textMarker]}\n      />\n    </div>\n  )\n}\n\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}