{"version":3,"sources":["../../src/index.jsx","App.js","index.js"],"names":["TextMarker","layout","x","y","color","fontFamily","gap","i","id","label","opacity","pointer","size","transforms","yOffset","labelRef","useRef","useState","visible","setVisible","useEffect","first","second","allTexts","current","viewportElement","querySelectorAll","thisBox","getBBox","text","otherBox","width","height","labelX","labelAnchor","tx","ty","React","fill","fontSize","textAnchor","data-text-marker-pointer","ref","data-text-marker-label","textMarker","element","map","key","sceneSettings","cubeRange","cubeZoffset","dataXoffset","dataYoffset","dataZoffset","paperXrange","window","innerWidth","paperYrange","innerHeight","sceneOptions","paper","xyPlane","sceneEdges","crossLines","emptySceneOptions","App","zoom","setZoom","rotateX","setRotateX","rotateY","setRotateY","viewSettings","camTx","camTy","camTz","cubeRx","cubeRy","cubeRz","camZoom","canvasToViewRatio","defaultCamZoffset","defaultCamOrientation","points","renderScene","data","catalog","star","type","location","z","push","name","symbol","labelSize","style","onWheel","e","destZoom","deltaY","onMouseMove","clientX","clientY","className","href","container","xRange","yRange","plugins","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.888e2710.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\n\nconst collides = (first, second) => {\n  return first.x < second.x + second.width &&\n         first.x + first.width > second.x &&\n         first.y < second.y + second.height &&\n         first.y + first.height > second.y\n}\n\nconst TextMarker = ({\n    x,\n    y,\n    color,\n    fontFamily,\n    gap,\n    i,\n    id,\n    label,\n    opacity,\n    pointer,\n    size,\n    transforms,\n    yOffset,\n    layout,\n  }) => {\n  const labelRef = useRef()\n  opacity ||= 1\n  size ||= 16\n  pointer ||= '•'\n  gap ||= size/2\n  yOffset ||= size/3\n  layout ||= 'east'\n\n  const [ visible, setVisible ] = useState(false)\n\n  const checkOverlab = () => {\n    const allTexts = labelRef.current.viewportElement.querySelectorAll('[data-text-marker-label]')\n    let thisBox = labelRef.current.getBBox()\n    for(let text of allTexts) {\n      if (labelRef.current === text) {\n        setVisible(true)\n        return\n      }\n      let otherBox = text.getBBox()\n      if (collides(thisBox, otherBox)) {\n        setVisible(false)\n        return\n      }\n    }\n    setVisible(true)\n  }\n\n  useEffect(() => {\n    checkOverlab()\n  }, [x,y])\n\n  const tx = transforms.tx(x)\n  const ty = transforms.ty(y)+yOffset\n\n  let labelX, labelAnchor\n\n  switch (layout) {\n    case 'east':\n      labelX = tx + gap\n      labelAnchor = 'start'\n      break;\n    case 'west':\n      labelX = tx - gap\n      labelAnchor = 'end'\n      break;\n  }\n\n  return (\n    <g\n      fill={color}\n      fontSize={size}\n      fontFamily={fontFamily}\n      id={`${id}-${i}`}\n    >\n      <text\n        x={tx}\n        y={ty}\n        textAnchor=\"middle\"\n        data-text-marker-pointer={true}\n      >\n        {pointer}\n      </text>\n      <text\n        x={labelX}\n        y={ty}\n        ref={labelRef}\n        opacity={visible ? opacity : 0}\n        textAnchor={labelAnchor}\n        data-text-marker-label={true}\n      >\n        {label}\n      </text>\n    </g>\n  )\n}\n\nconst textMarkerPlugin = {\n  textMarker: (element, transforms) => {\n    const {\n      size,\n      color,\n      opacity,\n      id,\n      label,\n      pointer,\n      fontFamily,\n      yOffset,\n      layout,\n    } = element\n    return element.x.map((x, i) => (\n      <TextMarker\n        {...{\n          x,\n          y: element.y[i],\n          color,\n          fontFamily,\n          i,\n          id,\n          label,\n          opacity,\n          pointer,\n          size,\n          transforms,\n          yOffset,\n          layout,\n        }}\n        key={`${id}-${i}`}\n      />\n    ))\n  }\n}\n\nexport default textMarkerPlugin\n","import React, { useState } from 'react'\nimport BareMinimum2d from 'bare-minimum-2d'\nimport renderScene from '@mithi/bare-minimum-3d'\nimport catalog from './catalog.json'\nimport textMarker from 'bare-minimum-text-marker'\n\nconst sceneSettings = {\n  cubeRange: 20,\n  cubeZoffset: 0,\n  dataXoffset: 0,\n  dataYoffset: 0,\n  dataZoffset: .25,\n  paperXrange: window.innerWidth,\n  paperYrange: window.innerHeight,\n}\n\nconst sceneOptions = {\n  paper: false,\n  xyPlane: false,\n  sceneEdges: { color: \"#607D8B\", opacity: 1 },\n  crossLines: false,\n}\n\nconst emptySceneOptions = {\n  paper: false,\n  xyPlane: false,\n  sceneEdges: false,\n  crossLines: false,\n}\n\nfunction App() {\n  const [zoom, setZoom] = useState(2);\n  const [rotateX, setRotateX] = useState(0);\n  const [rotateY, setRotateY] = useState(0);\n\n  const viewSettings = {\n    camTx: 0,\n    camTy: 0,\n    camTz: 0,\n    cubeRx: rotateX,\n    cubeRy: 0,\n    cubeRz: rotateY,\n    camZoom: zoom,\n    canvasToViewRatio: 300,\n    defaultCamZoffset: 5,\n    defaultCamOrientation: \"z-forward-x-right\",\n  }\n\n  let { data } = renderScene(\n    viewSettings,\n    sceneSettings,\n    sceneOptions,\n    [],\n  )\n\n  let points = [\n    data[0]\n  ]\n  for (let star of catalog) {\n    let { data } = renderScene(\n      viewSettings,\n      sceneSettings,\n      emptySceneOptions,\n      [{\n        type: 'points',\n        x: [star.location.x],\n        y: [star.location.y],\n        z: [star.location.z],\n      }],\n    )\n\n    const labelSize = 16\n\n    points.push({\n      ...data[0],\n      label: star.name,\n      id: star.name,\n      pointer: star.symbol ? star.symbol : null,\n      type: 'textMarker',\n      opacity: 1,\n      size: labelSize, \n      yOffset: star.symbol !== '☉' ? labelSize/2.8 : labelSize/4, \n      color: 'white',\n      layout: data[0].x > 0 ? 'east' : 'west',\n    })\n\n  }\n\n  return (\n    <div\n      style={{ width: '100%', height: window.innerHeight }}\n      onWheel={(e) => {\n        let destZoom = zoom + (e.deltaY/100)\n        if (destZoom > 0) {\n          setZoom(destZoom)\n        }\n      }}\n      onMouseMove={(e) => {\n        setRotateY(-e.clientX/3)\n        setRotateX(e.clientY/3)\n      }}\n    >\n      <div className=\"intro\">\n        <p>\n          This is a demo application of the \n          {' '}\n          <a href=\"https://www.npmjs.com/package/bare-minimum-text-marker\">bare-minimum-text-marker</a>\n          {' '}\n          plugin for\n          {' '}\n          <a href=\"https://github.com/mithi/bare-minimum-2d\">\n            bare-minimum-2d\n          </a>\n          {' '}\n          and \n          {' '}\n          <a href=\"https://github.com/mithi/bare-minimum-3d\">\n            3d\n          </a>\n          .\n        </p>\n        <p>\n          It allows you to place a text next to a point. The component\n          makes sure that text does not overlap. \n        </p> \n        <p>\n          This demo visualises the stellar neigborhood of the sun (☉). \n        </p> \n        <p>\n          Data extracted from \n          {' '}\n          <a href=\"https://www.wikidata.org/\">wikidata</a>\n          {' '}\n          <small>(<a href=\"https://creativecommons.org/publicdomain/zero/1.0/\">CC0 License</a>)</small>\n        </p> \n      </div>\n      <BareMinimum2d\n        container={{\n          color: 'black',\n          opacity: 'black',\n          xRange: 1000,\n          yRange: 2000\n        }}\n        data={points}\n        plugins={[textMarker]}\n      />\n    </div>\n  )\n}\n\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}